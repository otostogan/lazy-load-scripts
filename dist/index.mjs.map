{"version":3,"sources":["../src/lazyload.ts","../src/index.ts"],"sourcesContent":["export class LazyLoadScripts {\n\tprivate triggerEvents: string[];\n\tprivate userEventHandler: EventListener;\n\tprivate touchStartHandler: EventListener;\n\tprivate touchMoveHandler: EventListener;\n\tprivate touchEndHandler: EventListener;\n\tprivate clickHandler: EventListener;\n\tprivate interceptedClicks: MouseEvent[];\n\tprivate delayedScripts: {\n\t\tnormal: HTMLScriptElement[];\n\t\tasync: HTMLScriptElement[];\n\t\tdefer: HTMLScriptElement[];\n\t};\n\tprivate allJQueries: any[];\n\tprivate persisted?: boolean;\n\tprivate lastBreath: number = 0;\n\tprivate domReadyFired?: boolean;\n\n\tconstructor() {\n\t\tthis.triggerEvents = [\n\t\t\t\"keydown\",\n\t\t\t\"mousedown\",\n\t\t\t\"mousemove\",\n\t\t\t\"touchmove\",\n\t\t\t\"touchstart\",\n\t\t\t\"touchend\",\n\t\t\t\"wheel\",\n\t\t];\n\t\tthis.userEventHandler = this._triggerListener.bind(this);\n\t\tthis.touchStartHandler = this._onTouchStart.bind(this);\n\t\tthis.touchMoveHandler = this._onTouchMove.bind(this);\n\t\tthis.touchEndHandler = this._onTouchEnd.bind(this);\n\t\tthis.clickHandler = this._onClick.bind(this);\n\t\tthis.interceptedClicks = [];\n\t\twindow.addEventListener(\"pageshow\", (e: PageTransitionEvent) => {\n\t\t\tthis.persisted = e.persisted;\n\t\t});\n\t\twindow.addEventListener(\"DOMContentLoaded\", () => {\n\t\t\tthis._preconnect3rdParties();\n\t\t});\n\t\tthis.delayedScripts = { normal: [], async: [], defer: [] };\n\t\tthis.allJQueries = [];\n\t}\n\n\tprivate _addUserInteractionListener(e: LazyLoadScripts): void {\n\t\tdocument.hidden\n\t\t\t? e._triggerListener()\n\t\t\t: (this.triggerEvents.forEach((t) =>\n\t\t\t\t\twindow.addEventListener(t, e.userEventHandler, {\n\t\t\t\t\t\tpassive: !0,\n\t\t\t\t\t})\n\t\t\t  ),\n\t\t\t  window.addEventListener(\"touchstart\", e.touchStartHandler, {\n\t\t\t\t\tpassive: !0,\n\t\t\t  }),\n\t\t\t  window.addEventListener(\"mousedown\", e.touchStartHandler),\n\t\t\t  document.addEventListener(\n\t\t\t\t\t\"visibilitychange\",\n\t\t\t\t\te.userEventHandler\n\t\t\t  ));\n\t}\n\tprivate _removeUserInteractionListener(): void {\n\t\tthis.triggerEvents.forEach((e) =>\n\t\t\twindow.removeEventListener(e as string, this.userEventHandler, {})\n\t\t),\n\t\t\tdocument.removeEventListener(\n\t\t\t\t\"visibilitychange\",\n\t\t\t\tthis.userEventHandler\n\t\t\t);\n\t}\n\tprivate _onTouchStart: EventListener = (e: Event) => {\n\t\tif (e.target instanceof HTMLElement && e.target.tagName !== \"HTML\") {\n\t\t\twindow.addEventListener(\"touchend\", this.touchEndHandler);\n\t\t\twindow.addEventListener(\"mouseup\", this.touchEndHandler);\n\t\t\twindow.addEventListener(\"touchmove\", this.touchMoveHandler, {\n\t\t\t\tpassive: true,\n\t\t\t});\n\t\t\twindow.addEventListener(\"mousemove\", this.touchMoveHandler);\n\t\t\te.target.addEventListener(\"click\", this.clickHandler);\n\t\t\tthis._renameDOMAttribute(e.target, \"onclick\", \"lazy-onclick\");\n\t\t}\n\t};\n\tprivate _onTouchMove: EventListener = (e: Event) => {\n\t\twindow.removeEventListener(\"touchend\", this.touchEndHandler);\n\t\twindow.removeEventListener(\"mouseup\", this.touchEndHandler);\n\t\twindow.removeEventListener(\"touchmove\", this.touchMoveHandler);\n\t\twindow.removeEventListener(\"mousemove\", this.touchMoveHandler);\n\t\tif (e.target instanceof HTMLElement) {\n\t\t\te.target.removeEventListener(\"click\", this.clickHandler);\n\t\t\tthis._renameDOMAttribute(e.target, \"lazy-onclick\", \"onclick\");\n\t\t}\n\t};\n\tprivate _onTouchEnd: EventListener = (e: Event) => {\n\t\twindow.removeEventListener(\"touchend\", this.touchEndHandler);\n\t\twindow.removeEventListener(\"mouseup\", this.touchEndHandler);\n\t\twindow.removeEventListener(\"touchmove\", this.touchMoveHandler);\n\t\twindow.removeEventListener(\"mousemove\", this.touchMoveHandler);\n\t};\n\tprivate _onClick: EventListener = (e: Event) => {\n\t\tif (e.target instanceof HTMLElement) {\n\t\t\te.target.removeEventListener(\"click\", this.clickHandler);\n\t\t\tthis._renameDOMAttribute(e.target, \"lazy-onclick\", \"onclick\");\n\t\t\tthis.interceptedClicks.push(e as MouseEvent);\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\t};\n\tprivate _replayClicks(): void {\n\t\twindow.removeEventListener(\"touchstart\", this.touchStartHandler);\n\t\twindow.removeEventListener(\"mousedown\", this.touchStartHandler);\n\t\tthis.interceptedClicks.forEach((e) => {\n\t\t\tif (e.target)\n\t\t\t\te.target.dispatchEvent(\n\t\t\t\t\tnew MouseEvent(\"click\", {\n\t\t\t\t\t\tview: e.view,\n\t\t\t\t\t\tbubbles: true,\n\t\t\t\t\t\tcancelable: true,\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t});\n\t}\n\tprivate _renameDOMAttribute(e: HTMLElement, t: string, n: string): void {\n\t\tif (e.hasAttribute(t)) {\n\t\t\te.setAttribute(n, e.getAttribute(t)!);\n\t\t\te.removeAttribute(t);\n\t\t}\n\t}\n\tprivate _triggerListener(): void {\n\t\tthis._removeUserInteractionListener();\n\t\tif (document.readyState === \"loading\") {\n\t\t\tdocument.addEventListener(\n\t\t\t\t\"DOMContentLoaded\",\n\t\t\t\tthis._loadEverythingNow.bind(this)\n\t\t\t);\n\t\t} else {\n\t\t\tthis._loadEverythingNow();\n\t\t}\n\t}\n\tprivate _preconnect3rdParties(): void {\n\t\tlet e: Array<{ src: string; crossOrigin: string | boolean }> = [];\n\t\tdocument\n\t\t\t.querySelectorAll(\"script[type=lazyloadscript]\")\n\t\t\t.forEach((el) => {\n\t\t\t\tconst t = el as HTMLScriptElement;\n\t\t\t\tif (t.hasAttribute(\"src\")) {\n\t\t\t\t\tconst n = new URL(t.src).origin;\n\t\t\t\t\tif (n !== location.origin) {\n\t\t\t\t\t\te.push({\n\t\t\t\t\t\t\tsrc: n,\n\t\t\t\t\t\t\tcrossOrigin:\n\t\t\t\t\t\t\t\tt.crossOrigin ||\n\t\t\t\t\t\t\t\tt.getAttribute(\"data-lazy-type\") === \"module\",\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\te = [\n\t\t\t...new Map(e.map((item) => [JSON.stringify(item), item])).values(),\n\t\t];\n\t\tthis._batchInjectResourceHints(e as HTMLScriptElement[], \"preconnect\");\n\t}\n\tprivate async _loadEverythingNow(): Promise<void> {\n\t\tthis.domReadyFired = true;\n\t\tthis.lastBreath = Date.now();\n\t\tthis._delayEventListeners();\n\t\tthis._delayJQueryReady(this);\n\t\tthis._handleDocumentWrite();\n\t\tthis._registerAllDelayedScripts();\n\t\tthis._preloadAllScripts();\n\t\tawait this._loadScriptsFromList(this.delayedScripts.normal);\n\t\tawait this._loadScriptsFromList(this.delayedScripts.defer);\n\t\tawait this._loadScriptsFromList(this.delayedScripts.async);\n\t\ttry {\n\t\t\tawait this._triggerDOMContentLoaded();\n\t\t\tawait this._triggerWindowLoad();\n\t\t} catch (e) {}\n\t\twindow.dispatchEvent(new Event(\"lazy-allScriptsLoaded\"));\n\t\tthis._replayClicks();\n\t}\n\n\tprivate _registerAllDelayedScripts(): void {\n\t\tdocument\n\t\t\t.querySelectorAll(\"script[type=lazyloadscript]\")\n\t\t\t.forEach((el) => {\n\t\t\t\tconst e = el as HTMLScriptElement;\n\t\t\t\tif (e.hasAttribute(\"src\")) {\n\t\t\t\t\tif (e.hasAttribute(\"async\") && e.async !== false) {\n\t\t\t\t\t\tthis.delayedScripts.async.push(e);\n\t\t\t\t\t} else if (\n\t\t\t\t\t\t(e.hasAttribute(\"defer\") && e.defer !== false) ||\n\t\t\t\t\t\te.getAttribute(\"data-lazy-type\") === \"module\"\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis.delayedScripts.defer.push(e);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.delayedScripts.normal.push(e);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.delayedScripts.normal.push(e);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tprivate async _transformScript(e: HTMLScriptElement): Promise<void> {\n\t\tawait this._littleBreath();\n\t\treturn new Promise((resolve) => {\n\t\t\tconst n = document.createElement(\"script\");\n\t\t\tArray.from(e.attributes).forEach((attr) => {\n\t\t\t\tlet t = attr.nodeName;\n\t\t\t\tif (t !== \"type\") {\n\t\t\t\t\tif (t === \"data-lazy-type\") t = \"type\";\n\t\t\t\t\tn.setAttribute(t, attr.nodeValue!);\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (e.hasAttribute(\"src\")) {\n\t\t\t\tn.addEventListener(\"load\", () => resolve());\n\t\t\t\tn.addEventListener(\"error\", () => resolve());\n\t\t\t} else {\n\t\t\t\tn.text = e.text;\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\ttry {\n\t\t\t\te.parentNode?.replaceChild(n, e);\n\t\t\t} catch (err) {\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate async _loadScriptsFromList(e: HTMLScriptElement[]): Promise<void> {\n\t\tconst t = e.shift();\n\t\tif (t) {\n\t\t\tawait this._transformScript(t);\n\t\t\treturn this._loadScriptsFromList(e);\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\tprivate _preloadAllScripts(): void {\n\t\tthis._batchInjectResourceHints(\n\t\t\t[\n\t\t\t\t...this.delayedScripts.normal,\n\t\t\t\t...this.delayedScripts.defer,\n\t\t\t\t...this.delayedScripts.async,\n\t\t\t],\n\t\t\t\"preload\"\n\t\t);\n\t}\n\n\tprivate _batchInjectResourceHints(\n\t\tscripts: HTMLScriptElement[],\n\t\trel: string\n\t): void {\n\t\tconst fragment = document.createDocumentFragment();\n\n\t\tscripts.forEach((script) => {\n\t\t\tif (script.src) {\n\t\t\t\tconst link = document.createElement(\"link\");\n\t\t\t\tlink.href = script.src;\n\t\t\t\tlink.rel = rel;\n\t\t\t\tif (rel !== \"preconnect\") {\n\t\t\t\t\tlink.as = \"script\";\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tscript.getAttribute &&\n\t\t\t\t\tscript.getAttribute(\"data-lazy-type\") === \"module\"\n\t\t\t\t) {\n\t\t\t\t\tlink.crossOrigin = \"true\";\n\t\t\t\t}\n\t\t\t\tif (script.crossOrigin) {\n\t\t\t\t\tlink.crossOrigin = script.crossOrigin;\n\t\t\t\t}\n\t\t\t\tfragment.appendChild(link);\n\t\t\t}\n\t\t});\n\n\t\tdocument.head.appendChild(fragment);\n\t}\n\n\tprivate _delayEventListeners(): void {\n\t\tconst eventMap: {\n\t\t\t[key: string]: {\n\t\t\t\toriginalFunctions: {\n\t\t\t\t\tadd: typeof EventTarget.prototype.addEventListener;\n\t\t\t\t\tremove: typeof EventTarget.prototype.removeEventListener;\n\t\t\t\t};\n\t\t\t\teventsToRewrite: string[];\n\t\t\t};\n\t\t} = {};\n\n\t\tfunction rewriteEventListeners(\n\t\t\ttarget: EventTarget,\n\t\t\teventName: string\n\t\t): void {\n\t\t\tif (!eventMap[target as any]) {\n\t\t\t\teventMap[target as any] = {\n\t\t\t\t\toriginalFunctions: {\n\t\t\t\t\t\tadd: target.addEventListener.bind(target),\n\t\t\t\t\t\tremove: target.removeEventListener.bind(target),\n\t\t\t\t\t},\n\t\t\t\t\teventsToRewrite: [],\n\t\t\t\t};\n\t\t\t\ttarget.addEventListener = function (\n\t\t\t\t\tevent: string | Event,\n\t\t\t\t\tlistener: EventListenerOrEventListenerObject,\n\t\t\t\t\toptions?: boolean | AddEventListenerOptions\n\t\t\t\t): void {\n\t\t\t\t\tif (typeof event === \"string\") {\n\t\t\t\t\t\tconst eventNameStr =\n\t\t\t\t\t\t\teventMap[target as any].eventsToRewrite.indexOf(\n\t\t\t\t\t\t\t\tevent\n\t\t\t\t\t\t\t) >= 0\n\t\t\t\t\t\t\t\t? `lazy-${event}`\n\t\t\t\t\t\t\t\t: event;\n\t\t\t\t\t\teventMap[target as any].originalFunctions.add(\n\t\t\t\t\t\t\teventNameStr,\n\t\t\t\t\t\t\tlistener,\n\t\t\t\t\t\t\toptions\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\teventMap[target as any].originalFunctions.add(\n\t\t\t\t\t\t\tevent.type,\n\t\t\t\t\t\t\tlistener,\n\t\t\t\t\t\t\toptions\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\ttarget.removeEventListener = function (\n\t\t\t\t\tevent: string | Event,\n\t\t\t\t\tlistener: EventListenerOrEventListenerObject,\n\t\t\t\t\toptions?: boolean | EventListenerOptions\n\t\t\t\t): void {\n\t\t\t\t\tif (typeof event === \"string\") {\n\t\t\t\t\t\tconst eventNameStr =\n\t\t\t\t\t\t\teventMap[target as any].eventsToRewrite.indexOf(\n\t\t\t\t\t\t\t\tevent\n\t\t\t\t\t\t\t) >= 0\n\t\t\t\t\t\t\t\t? `lazy-${event}`\n\t\t\t\t\t\t\t\t: event;\n\t\t\t\t\t\teventMap[target as any].originalFunctions.remove(\n\t\t\t\t\t\t\teventNameStr,\n\t\t\t\t\t\t\tlistener,\n\t\t\t\t\t\t\toptions\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\teventMap[target as any].originalFunctions.remove(\n\t\t\t\t\t\t\tevent.type,\n\t\t\t\t\t\t\tlistener,\n\t\t\t\t\t\t\toptions\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\teventMap[target as any].eventsToRewrite.push(eventName);\n\t\t}\n\n\t\tfunction definePropertyWithLazyPrefix(\n\t\t\tobj: any,\n\t\t\tpropName: string\n\t\t): void {\n\t\t\tconst originalValue = obj[propName];\n\t\t\tObject.defineProperty(obj, propName, {\n\t\t\t\tget: () => originalValue || function () {},\n\t\t\t\tset(value) {\n\t\t\t\t\tobj[`lazy${propName}`] = value;\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\trewriteEventListeners(document, \"DOMContentLoaded\");\n\t\trewriteEventListeners(window, \"DOMContentLoaded\");\n\t\trewriteEventListeners(window, \"load\");\n\t\trewriteEventListeners(window, \"pageshow\");\n\t\trewriteEventListeners(document, \"readystatechange\");\n\n\t\tdefinePropertyWithLazyPrefix(document, \"onreadystatechange\");\n\t\tdefinePropertyWithLazyPrefix(window, \"onload\");\n\t\tdefinePropertyWithLazyPrefix(window, \"onpageshow\");\n\t}\n\n\tprivate _delayJQueryReady(e: this): void {\n\t\tlet originalJQuery = window.jQuery;\n\n\t\tObject.defineProperty(window, \"jQuery\", {\n\t\t\tget: () => originalJQuery,\n\t\t\tset(newJQuery) {\n\t\t\t\tif (\n\t\t\t\t\tnewJQuery &&\n\t\t\t\t\tnewJQuery.fn &&\n\t\t\t\t\t!e.allJQueries.includes(newJQuery)\n\t\t\t\t) {\n\t\t\t\t\tnewJQuery.fn.ready = newJQuery.fn.init.prototype.ready =\n\t\t\t\t\t\tfunction (callback: (context: any) => void) {\n\t\t\t\t\t\t\tif (e.domReadyFired) {\n\t\t\t\t\t\t\t\tcallback.bind(document)(newJQuery);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdocument.addEventListener(\n\t\t\t\t\t\t\t\t\t\"lazy-DOMContentLoaded\",\n\t\t\t\t\t\t\t\t\t() => callback.bind(document)(newJQuery)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\tconst originalOn = newJQuery.fn.on;\n\t\t\t\t\tnewJQuery.fn.on = newJQuery.fn.init.prototype.on =\n\t\t\t\t\t\tfunction (...args: any[]) {\n\t\t\t\t\t\t\tif (this[0] === window) {\n\t\t\t\t\t\t\t\tfunction transformEventNames(\n\t\t\t\t\t\t\t\t\tevents: string\n\t\t\t\t\t\t\t\t): string {\n\t\t\t\t\t\t\t\t\treturn events\n\t\t\t\t\t\t\t\t\t\t.split(\" \")\n\t\t\t\t\t\t\t\t\t\t.map((event) =>\n\t\t\t\t\t\t\t\t\t\t\tevent === \"load\" ||\n\t\t\t\t\t\t\t\t\t\t\tevent.startsWith(\"load.\")\n\t\t\t\t\t\t\t\t\t\t\t\t? \"lazy-jquery-load\"\n\t\t\t\t\t\t\t\t\t\t\t\t: event\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t.join(\" \");\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\ttypeof args[0] === \"string\" ||\n\t\t\t\t\t\t\t\t\targs[0] instanceof String\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\targs[0] = transformEventNames(\n\t\t\t\t\t\t\t\t\t\targs[0] as string\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} else if (typeof args[0] === \"object\") {\n\t\t\t\t\t\t\t\t\tObject.keys(args[0]).forEach((key) => {\n\t\t\t\t\t\t\t\t\t\tconst newKey = transformEventNames(key);\n\t\t\t\t\t\t\t\t\t\tif (newKey !== key) {\n\t\t\t\t\t\t\t\t\t\t\targs[0][newKey] = args[0][key];\n\t\t\t\t\t\t\t\t\t\t\tdelete args[0][key];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn originalOn.apply(this, args);\n\t\t\t\t\t\t};\n\n\t\t\t\t\te.allJQueries.push(newJQuery);\n\t\t\t\t}\n\t\t\t\toriginalJQuery = newJQuery;\n\t\t\t},\n\t\t});\n\t}\n\n\tprivate async _triggerDOMContentLoaded(): Promise<void> {\n\t\tthis.domReadyFired = true;\n\t\tawait this._littleBreath();\n\t\tdocument.dispatchEvent(new Event(\"lazy-DOMContentLoaded\"));\n\t\tawait this._littleBreath();\n\t\twindow.dispatchEvent(new Event(\"lazy-DOMContentLoaded\"));\n\t\tawait this._littleBreath();\n\t\tdocument.dispatchEvent(new Event(\"lazy-readystatechange\"));\n\t\tawait this._littleBreath();\n\t\t(document as any).lazyonreadystatechange?.();\n\t}\n\n\tprivate async _triggerWindowLoad(): Promise<void> {\n\t\tawait this._littleBreath();\n\t\twindow.dispatchEvent(new Event(\"lazy-load\"));\n\t\tawait this._littleBreath();\n\t\t(window as any).lazyonload?.();\n\t\tawait this._littleBreath();\n\t\tthis.allJQueries.forEach((e) => e(window).trigger(\"lazy-jquery-load\"));\n\t\tawait this._littleBreath();\n\t\tconst e = new Event(\"lazy-pageshow\");\n\t\t(e as any).persisted = this.persisted;\n\t\twindow.dispatchEvent(e);\n\t\tawait this._littleBreath();\n\t\t(window as any).lazyonpageshow?.({ persisted: this.persisted });\n\t}\n\n\tprivate _handleDocumentWrite(): void {\n\t\tlet e = document.write;\n\t\tlet t = document.writeln;\n\t\tdocument.write = document.writeln = function (...args: string[]): void {\n\t\t\tif (document.readyState === \"loading\") {\n\t\t\t\te.apply(document, args);\n\t\t\t\tt.apply(document, args);\n\t\t\t} else {\n\t\t\t\tconsole.log(\"document.write is disabled once DOM is loaded\");\n\t\t\t}\n\t\t};\n\t}\n\n\tasync _littleBreath() {\n\t\tif (Date.now() - this.lastBreath > 45) {\n\t\t\tawait this._requestAnimFrame();\n\t\t\tthis.lastBreath = Date.now();\n\t\t}\n\t}\n\tasync _requestAnimFrame() {\n\t\treturn document.hidden\n\t\t\t? new Promise((e) => setTimeout(e))\n\t\t\t: new Promise((e) => requestAnimationFrame(e));\n\t}\n\tstatic run() {\n\t\tconst e = new LazyLoadScripts();\n\t\te._addUserInteractionListener(e);\n\t}\n}\n","import { LazyLoadScripts } from \"./lazyload\";\n\nexport default LazyLoadScripts;\n"],"mappings":"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","names":["transformEventNames","e"]}